<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>CWB: utils/feature_maps.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CWB
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cbdb8362360e11eafe2fa3bc74cf0ffd.html">utils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">feature_maps.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="feature__maps_8h.html">feature_maps.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="barlib_8h.html">barlib.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a70d84389e10769651ac8977307897b6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a70d84389e10769651ac8977307897b6a">init_char_map</a> ()</td></tr>
<tr class="memdesc:a70d84389e10769651ac8977307897b6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialises char_map,  <a href="#a70d84389e10769651ac8977307897b6a">More...</a><br /></td></tr>
<tr class="separator:a70d84389e10769651ac8977307897b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d7a123154f8cd5cbb70da2c744af58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a26d7a123154f8cd5cbb70da2c744af58">create_feature_maps</a> (char **<a class="el" href="cwb-align_8c.html#ac33cd46fdc13e84798f29ba36fca7c49">config</a>, int <a class="el" href="cwb-align_8c.html#af9e9b17b172c26928f89b715e5502f7a">config_lines</a>, <a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *w_attr1, <a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *w_attr2, <a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *s_attr1, <a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *s_attr2)</td></tr>
<tr class="memdesc:a26d7a123154f8cd5cbb70da2c744af58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods for the FMS class.  <a href="#a26d7a123154f8cd5cbb70da2c744af58">More...</a><br /></td></tr>
<tr class="separator:a26d7a123154f8cd5cbb70da2c744af58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bfe40928694bc7b327a106f8a0d4b97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a8bfe40928694bc7b327a106f8a0d4b97">feature_match</a> (<a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms, int f1, int l1, int f2, int l2)</td></tr>
<tr class="memdesc:a8bfe40928694bc7b327a106f8a0d4b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute similarity measure for a pair of regions, source and target, specified by the corpus positions of the first and last sentences in each region.  <a href="#a8bfe40928694bc7b327a106f8a0d4b97">More...</a><br /></td></tr>
<tr class="separator:a8bfe40928694bc7b327a106f8a0d4b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e72d66c846aa1354e001d1d0c00aee5"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a9e72d66c846aa1354e001d1d0c00aee5">get_fvector</a> (<a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms)</td></tr>
<tr class="memdesc:a9e72d66c846aa1354e001d1d0c00aee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Feature count vector handling (used internally by feature_match).  <a href="#a9e72d66c846aa1354e001d1d0c00aee5">More...</a><br /></td></tr>
<tr class="separator:a9e72d66c846aa1354e001d1d0c00aee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8434c691124c3f744b21c938b7c933d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a8434c691124c3f744b21c938b7c933d1">release_fvector</a> (int *fvector, <a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms)</td></tr>
<tr class="memdesc:a8434c691124c3f744b21c938b7c933d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a new <a class="el" href="structvstack__t.html" title="Data structure for the vstack member of the FMS object. ">vstack_t</a> at the start of the vstack member of the given FMS.  <a href="#a8434c691124c3f744b21c938b7c933d1">More...</a><br /></td></tr>
<tr class="separator:a8434c691124c3f744b21c938b7c933d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17fb6034d6db383984921397dd3b84d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a17fb6034d6db383984921397dd3b84d7">check_fvectors</a> (<a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms)</td></tr>
<tr class="memdesc:a17fb6034d6db383984921397dd3b84d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints a message about the vector stack of the given FMS.  <a href="#a17fb6034d6db383984921397dd3b84d7">More...</a><br /></td></tr>
<tr class="separator:a17fb6034d6db383984921397dd3b84d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645770de72b8b9d14feec79e87aab137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a645770de72b8b9d14feec79e87aab137">show_features</a> (<a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms, int which, char *<a class="el" href="eval_8h.html#a93fe6fe1a66a9de33bb160f0c3e18954a09c37d051e7e4b3f3a7e8e75dca15912">word</a>)</td></tr>
<tr class="memdesc:a645770de72b8b9d14feec79e87aab137"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the features in an FMS, as applied to a specific lexicon entry, to STDOUT.  <a href="#a645770de72b8b9d14feec79e87aab137">More...</a><br /></td></tr>
<tr class="separator:a645770de72b8b9d14feec79e87aab137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae625acd3e78c025421432ee6d4b61553"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#ae625acd3e78c025421432ee6d4b61553">best_path</a> (<a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> fms, int f1, int l1, int f2, int l2, int <a class="el" href="cwb-align_8c.html#a4b5a7d3f565a28f87e850d34d009fb7f">beam_width</a>, int <a class="el" href="cwb-encode_8c.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a>, int *steps, int **out1, int **out2, int **out_quality)</td></tr>
<tr class="memdesc:ae625acd3e78c025421432ee6d4b61553"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the best alignment path for the given spans of s-attribute instances in the source and target corpus.  <a href="#ae625acd3e78c025421432ee6d4b61553">More...</a><br /></td></tr>
<tr class="separator:ae625acd3e78c025421432ee6d4b61553"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a55ded3a7db80f158c668c5dfd764dca9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a55ded3a7db80f158c668c5dfd764dca9">char_map_range</a> = 0</td></tr>
<tr class="memdesc:a55ded3a7db80f158c668c5dfd764dca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">the top of the range of char_map's outputs  <a href="#a55ded3a7db80f158c668c5dfd764dca9">More...</a><br /></td></tr>
<tr class="separator:a55ded3a7db80f158c668c5dfd764dca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ef6ec1a12d6eea4de5810062a9668c"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="feature__maps_8c.html#a23ef6ec1a12d6eea4de5810062a9668c">char_map</a> [256]</td></tr>
<tr class="memdesc:a23ef6ec1a12d6eea4de5810062a9668c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A character map for computing n-gram features.  <a href="#a23ef6ec1a12d6eea4de5810062a9668c">More...</a><br /></td></tr>
<tr class="separator:a23ef6ec1a12d6eea4de5810062a9668c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae625acd3e78c025421432ee6d4b61553"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void best_path </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>beam_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>out1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>out2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int **&#160;</td>
          <td class="paramname"><em>out_quality</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the best alignment path for the given spans of s-attribute instances in the source and target corpus. </p>
<p>This function does a beamed dynamic programming search for the best path aligning the sentence regions (f1,l1) in the source corpus and (f2,l2) in the target corpus.</p>
<p>Allowed alignments are 1:0 0:1 1:1 2:1 1:2.</p>
<p>The results are returned in the vectors out1 and out2, which each contain a number of valid entries (alignment points) equal to {steps}.</p>
<p>Alignment points are given as sentence numbers and correspond to the start points of the sentences. At the end-of-region alignment point, sentence numbers will be l1 + 1 and l2 + 1, which must be considered by the caller if l1 (or l2) is the last sentence in the corpus!</p>
<p>The similarity measures of aligned regions are returned in the vector out_quality.</p>
<p>Memory allocated for the return vectors (out1, out2, out_quality) is managed by <a class="el" href="feature__maps_8c.html#ae625acd3e78c025421432ee6d4b61553" title="Finds the best alignment path for the given spans of s-attribute instances in the source and target c...">best_path()</a> and must not be freed by the caller. Calling <a class="el" href="feature__maps_8c.html#ae625acd3e78c025421432ee6d4b61553" title="Finds the best alignment path for the given spans of s-attribute instances in the source and target c...">best_path()</a> overwrites the results of the previous search.</p>
<p>Example usage:</p>
<p>best_path(FMS, f1, l1, f2, l2, beam_width, 0/1, &amp;steps, &amp;out1, &amp;out2, &amp;out_quality);</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fms</td><td>The FMS to use as comparison criteria. </td></tr>
    <tr><td class="paramname">f1</td><td>Index of first sentence in source region. </td></tr>
    <tr><td class="paramname">l1</td><td>Index of last sentence in source region </td></tr>
    <tr><td class="paramname">f2</td><td>Index of first sentence in target region. </td></tr>
    <tr><td class="paramname">l2</td><td>Index of last sentence in target region. </td></tr>
    <tr><td class="paramname">beam_width</td><td>Parameter for the beam search. </td></tr>
    <tr><td class="paramname">verbose</td><td>Boolean: iff true, prints progress messages on STDOUT. </td></tr>
    <tr><td class="paramname">steps</td><td>Put output here (see function description). </td></tr>
    <tr><td class="paramname">out1</td><td>Put output here (see function description). </td></tr>
    <tr><td class="paramname">out2</td><td>Put output here (see function description). </td></tr>
    <tr><td class="paramname">out_quality</td><td>Put output here (see function description). </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="barlib_8c.html#a26cb81965883d640a833e6f6e2f14e89">BAR_delete()</a>, <a class="el" href="barlib_8c.html#a713375f9458643fe6f7a56a9b78e74b1">BAR_new()</a>, <a class="el" href="barlib_8c.html#a954e8bca41efa9dacce7b677c9898bbf">BAR_read()</a>, <a class="el" href="barlib_8c.html#ac695ffba5e269641abf859eeaa5de3e2">BAR_write()</a>, <a class="el" href="cwb-align_8c.html#a4b5a7d3f565a28f87e850d34d009fb7f">beam_width</a>, and <a class="el" href="feature__maps_8c.html#a8bfe40928694bc7b327a106f8a0d4b97">feature_match()</a>.</p>

<p>Referenced by <a class="el" href="cwb-align_8c.html#ae0e843e0355a620061045ce69974e007">align_do_alignment()</a>.</p>

</div>
</div>
<a class="anchor" id="a17fb6034d6db383984921397dd3b84d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_fvectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints a message about the vector stack of the given FMS. </p>
<p>If it finds a non-zero-count, it prints a message to STDERR. If it doesn't, it prints a message to STDOUT with the count of feature vectors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fms</td><td>The FMS to check. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structvstack__t.html#a2f58a200597c4a59b70cc72ef2424788">vstack_t::fcount</a>, <a class="el" href="structfeature__maps__t.html#a615f82e4ab2bc2a43685a7694f424034">feature_maps_t::n_features</a>, <a class="el" href="structvstack__t.html#aabba6792954f303d49542fa48ea4970b">vstack_t::next</a>, and <a class="el" href="structfeature__maps__t.html#ac7b1f647cad8ea029b9548de24f47079">feature_maps_t::vstack</a>.</p>

</div>
</div>
<a class="anchor" id="a26d7a123154f8cd5cbb70da2c744af58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a> create_feature_maps </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>config_lines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *&#160;</td>
          <td class="paramname"><em>w_attr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *&#160;</td>
          <td class="paramname"><em>w_attr2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *&#160;</td>
          <td class="paramname"><em>s_attr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cl_8h.html#a2208213b2f6ba9c8a702b3c592086496">Attribute</a> *&#160;</td>
          <td class="paramname"><em>s_attr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Methods for the FMS class. </p>
<p>Here is how it works:</p>
<p>FMS = create_feature_maps(config, config_lines, source, target, source_s, target_s);</p>
<p>Input: feature map configuration (ASCII, parsed into separate items) word (or lemma) p-attributes of source and target corpus s-attributes for sentence boundaries in both corpora (source_s, target_s)</p>
<p>Output: set of relevant features mapping from lexicon IDs to feature sets wrapped in FMS struct returned from the function</p>
<p>In order to ensure a maximally compact encoding, feature sets are generated with a two-pass algorithm:</p>
<ol type="1">
<li>identify relevant features + number of active features for each lexicon ID</li>
<li>generate the actual feature sets Creates feature maps for a source/target corpus pair.</li>
</ol>
<p>This is the constructor function for the FMS class.</p>
<p>Example usage:</p>
<p>FMS = create_feature_maps(config_data, nr_of_config_lines, source_word, target_word, source_s, target_s);</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config</td><td>array of strings representing the feature map configuration. </td></tr>
    <tr><td class="paramname">config_lines</td><td>the number of configuration items stored in config. </td></tr>
    <tr><td class="paramname">w_attr1</td><td>The p-attribute in the first corpus to link. </td></tr>
    <tr><td class="paramname">w_attr2</td><td>The p-attribute in the second corpus to link. </td></tr>
    <tr><td class="paramname">s_attr1</td><td>The s-attribute in the first corpus to link. </td></tr>
    <tr><td class="paramname">s_attr2</td><td>The s-attribute in the second corpus to link. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the new FMS object. </dd></dl>

<p>References <a class="el" href="structfeature__maps__t.html#a3f33a107750fc1576a0296aacef9d3e1">feature_maps_t::att1</a>, <a class="el" href="structfeature__maps__t.html#a5769f2401439114e5bb502b0fe62bede">feature_maps_t::att2</a>, <a class="el" href="feature__maps_8c.html#a23ef6ec1a12d6eea4de5810062a9668c">char_map</a>, <a class="el" href="feature__maps_8c.html#a55ded3a7db80f158c668c5dfd764dca9">char_map_range</a>, <a class="el" href="cwb-check-input_8c.html#ab7d33183c58d7df43cc5602b9c842b37">charset</a>, <a class="el" href="attributes_8c.html#a424b58a80f9c87eae0e01c8f64d5b67a">cl_attribute_mother_corpus()</a>, <a class="el" href="cl_8h.html#a3786eda36f00b2645b6b3a9b77410644">cl_corpus_charset()</a>, <a class="el" href="cl_8h.html#a9e15a3c725711d9effd623b2f3e225be">cl_free</a>, <a class="el" href="cdaccess_8c.html#a96decca6cc290275c02aa48ebf943aa9">cl_id2freq()</a>, <a class="el" href="cdaccess_8c.html#aba8848d44ac4ea4d6ad600ac68cddf0e">cl_id2str()</a>, <a class="el" href="cdaccess_8c.html#a2498199ad3c16152f91c83cd667f3eea">cl_id2strlen()</a>, <a class="el" href="cdaccess_8c.html#a80f6431eb356913b2d3b84b9cbfaae37">cl_max_id()</a>, <a class="el" href="cl_8h.html#ad68dfe0ca2fbad5052e8213a06f5b4ba">CL_MAX_LINE_LENGTH</a>, <a class="el" href="cdaccess_8c.html#abed40ee846d5375f4f21d7ef2306fcc8">cl_str2id()</a>, <a class="el" href="cl_8h.html#aaa4e0fe15413118cb89b4b760b0ce6e3">cl_strcpy()</a>, <a class="el" href="cl_8h.html#a708281d7f482a1999c70df6c353d66e1">cl_string_canonical()</a>, <a class="el" href="cl_8h.html#a55b268240e8fe355978e6e6fb36d9aa1">cl_string_validate_encoding()</a>, <a class="el" href="cwb-align_8c.html#af9e9b17b172c26928f89b715e5502f7a">config_lines</a>, <a class="el" href="structfeature__maps__t.html#a1b65e09dc1493589585fd3e556a75a27">feature_maps_t::fweight</a>, <a class="el" href="cl_8h.html#a1f397c74f7f8ba3952858c70eb19d082">IGNORE_CASE</a>, <a class="el" href="cl_8h.html#a2e9f85ae8ad88191c60cf4269b9ab296">IGNORE_DIAC</a>, <a class="el" href="feature__maps_8c.html#a70d84389e10769651ac8977307897b6a">init_char_map()</a>, <a class="el" href="structfeature__maps__t.html#a615f82e4ab2bc2a43685a7694f424034">feature_maps_t::n_features</a>, <a class="el" href="structfeature__maps__t.html#aac99deaca25373d974a3efbdf554f837">feature_maps_t::s1</a>, <a class="el" href="structfeature__maps__t.html#a8ea4130966a8cc8c30768629f4c42084">feature_maps_t::s2</a>, <a class="el" href="cl_8h.html#aa018eeb7e5a4bb1586a3f4337011daeaa3946b00fe1f38206339d69285cda6b03">utf8</a>, <a class="el" href="structfeature__maps__t.html#ac7b1f647cad8ea029b9548de24f47079">feature_maps_t::vstack</a>, <a class="el" href="structfeature__maps__t.html#a786b9c6ff118fff4956bed0fad836c32">feature_maps_t::w2f1</a>, <a class="el" href="structfeature__maps__t.html#a7459877f520e0dc10cafdb7a5ecd1ced">feature_maps_t::w2f2</a>, <a class="el" href="cwb-align_8c.html#aa169cdf66f7c3d67468ae14af5910652">word1</a>, and <a class="el" href="cwb-align_8c.html#a3f289c42f752a8931f933c24fe6c04c6">word2</a>.</p>

<p>Referenced by <a class="el" href="cwb-align_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a8bfe40928694bc7b327a106f8a0d4b97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int feature_match </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute similarity measure for a pair of regions, source and target, specified by the corpus positions of the first and last sentences in each region. </p>
<p>(And by "sentences" we mean "instances of whatever it is this s-attribute represents".)</p>
<p>This is, basically, the "apply me" method for the FMS object.</p>
<p>Usage:</p>
<p>Sim = feature_match(FMS, source_first, source_last, target_first, target_last);</p>
<p>Note that the <a class="el" href="feature__maps_8c.html#ae625acd3e78c025421432ee6d4b61553" title="Finds the best alignment path for the given spans of s-attribute instances in the source and target c...">best_path()</a> function simply passes through the FMS to this function. That function makes the decisions about what is the best sequence of alignments - given the results it has got back from this sentence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fms</td><td>The feature map (which contains the s-attributes in question) </td></tr>
    <tr><td class="paramname">f1</td><td>Index of first "sentence" (i.e. entry on the s-attribute) of the region to analyse in the source. </td></tr>
    <tr><td class="paramname">l1</td><td>Index of last "sentence" of the region to analyse in the source. </td></tr>
    <tr><td class="paramname">f2</td><td>Index of first "sentence" (i.e. entry on the s-attribute) of the region to analyse in the target. </td></tr>
    <tr><td class="paramname">l2</td><td>Index of last "sentence" of the region to analyse in the target. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The similarity measurement for the pair of refgions. </dd></dl>

<p>References <a class="el" href="structfeature__maps__t.html#a3f33a107750fc1576a0296aacef9d3e1">feature_maps_t::att1</a>, <a class="el" href="structfeature__maps__t.html#a5769f2401439114e5bb502b0fe62bede">feature_maps_t::att2</a>, <a class="el" href="cdaccess_8c.html#a0a7fae031e5da3da00dad86317397657">cl_cpos2id()</a>, <a class="el" href="cdaccess_8c.html#af0793556b93840555bca436b399a00bd">cl_struc2cpos()</a>, <a class="el" href="structfeature__maps__t.html#a1b65e09dc1493589585fd3e556a75a27">feature_maps_t::fweight</a>, <a class="el" href="feature__maps_8c.html#a9e72d66c846aa1354e001d1d0c00aee5">get_fvector()</a>, <a class="el" href="feature__maps_8c.html#a8434c691124c3f744b21c938b7c933d1">release_fvector()</a>, <a class="el" href="structfeature__maps__t.html#aac99deaca25373d974a3efbdf554f837">feature_maps_t::s1</a>, <a class="el" href="structfeature__maps__t.html#a8ea4130966a8cc8c30768629f4c42084">feature_maps_t::s2</a>, <a class="el" href="structfeature__maps__t.html#a786b9c6ff118fff4956bed0fad836c32">feature_maps_t::w2f1</a>, and <a class="el" href="structfeature__maps__t.html#a7459877f520e0dc10cafdb7a5ecd1ced">feature_maps_t::w2f2</a>.</p>

<p>Referenced by <a class="el" href="cwb-align_8c.html#ae0e843e0355a620061045ce69974e007">align_do_alignment()</a>, and <a class="el" href="feature__maps_8h.html#ae625acd3e78c025421432ee6d4b61553">best_path()</a>.</p>

</div>
</div>
<a class="anchor" id="a9e72d66c846aa1354e001d1d0c00aee5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* get_fvector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Feature count vector handling (used internally by feature_match). </p>
<p>If the vstack of the FMS (head of linked list) does not yet contain anything, then a new integer array is created and a pointer to it is returned.</p>
<p>If the vstack is already set, then the fcount from the element at the top of the linked list is returned, and its record <a class="el" href="structvstack__t.html" title="Data structure for the vstack member of the FMS object. ">vstack_t</a> is deleted from the linked list stack.</p>
<p>IN OTHER WORDS, a vector of feature counts is provided EITHER by using the top one off the stack, OR by getting a new one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fms</td><td>The FMS to get a feature vector for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to array of integers (feature counts) big enough to hold th </dd></dl>

<p>References <a class="el" href="cl_8h.html#a9e15a3c725711d9effd623b2f3e225be">cl_free</a>, <a class="el" href="structvstack__t.html#a2f58a200597c4a59b70cc72ef2424788">vstack_t::fcount</a>, <a class="el" href="structfeature__maps__t.html#a615f82e4ab2bc2a43685a7694f424034">feature_maps_t::n_features</a>, <a class="el" href="structvstack__t.html#aabba6792954f303d49542fa48ea4970b">vstack_t::next</a>, and <a class="el" href="structfeature__maps__t.html#ac7b1f647cad8ea029b9548de24f47079">feature_maps_t::vstack</a>.</p>

<p>Referenced by <a class="el" href="feature__maps_8h.html#a8bfe40928694bc7b327a106f8a0d4b97">feature_match()</a>.</p>

</div>
</div>
<a class="anchor" id="a70d84389e10769651ac8977307897b6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_char_map </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialises char_map, </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="feature__maps_8c.html#a23ef6ec1a12d6eea4de5810062a9668c" title="A character map for computing n-gram features. ">char_map</a> for details </dd></dl>

<p>References <a class="el" href="feature__maps_8c.html#a23ef6ec1a12d6eea4de5810062a9668c">char_map</a>, and <a class="el" href="feature__maps_8c.html#a55ded3a7db80f158c668c5dfd764dca9">char_map_range</a>.</p>

<p>Referenced by <a class="el" href="feature__maps_8h.html#a26d7a123154f8cd5cbb70da2c744af58">create_feature_maps()</a>.</p>

</div>
</div>
<a class="anchor" id="a8434c691124c3f744b21c938b7c933d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void release_fvector </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>fvector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts a new <a class="el" href="structvstack__t.html" title="Data structure for the vstack member of the FMS object. ">vstack_t</a> at the start of the vstack member of the given FMS. </p>
<p>{That's what it looks like it does, not sure how the function name fits with that... ???? - AH} </p>

<p>References <a class="el" href="structfeature__maps__t.html#ac7b1f647cad8ea029b9548de24f47079">feature_maps_t::vstack</a>.</p>

<p>Referenced by <a class="el" href="feature__maps_8h.html#a8bfe40928694bc7b327a106f8a0d4b97">feature_match()</a>.</p>

</div>
</div>
<a class="anchor" id="a645770de72b8b9d14feec79e87aab137"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void show_features </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="feature__maps_8h.html#a39dcab9bc29ace538d5939df6723a824">FMS</a>&#160;</td>
          <td class="paramname"><em>fms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>which</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>word</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the features in an FMS, as applied to a specific lexicon entry, to STDOUT. </p>
<p>Usage: show_features(FMS, 1/2, "word");</p>
<p>This will print all features listed in FMS for the token "word"; "word" is looked up in the source corpus if the 2nd argument == 1, and in the target corpus otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fms</td><td>The FMS to print from. </td></tr>
    <tr><td class="paramname">which</td><td>Which corpus to look up? (See description) </td></tr>
    <tr><td class="paramname">word</td><td>The word-type to look up. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structfeature__maps__t.html#a3f33a107750fc1576a0296aacef9d3e1">feature_maps_t::att1</a>, <a class="el" href="structfeature__maps__t.html#a5769f2401439114e5bb502b0fe62bede">feature_maps_t::att2</a>, <a class="el" href="cdaccess_8c.html#abed40ee846d5375f4f21d7ef2306fcc8">cl_str2id()</a>, <a class="el" href="structfeature__maps__t.html#a1b65e09dc1493589585fd3e556a75a27">feature_maps_t::fweight</a>, <a class="el" href="structfeature__maps__t.html#a786b9c6ff118fff4956bed0fad836c32">feature_maps_t::w2f1</a>, and <a class="el" href="structfeature__maps__t.html#a7459877f520e0dc10cafdb7a5ecd1ced">feature_maps_t::w2f2</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a23ef6ec1a12d6eea4de5810062a9668c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char char_map[256]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A character map for computing n-gram features. </p>
<p>After initialisation, this array maps character codes which are to be included in n-grams to a position index without gaps, and all other codes to the index 1.</p>
<p>Basically, when all is said and done, all possible bytes map to a number that represents position in the (unaccented, caseless) Latin alphabet, where where (a|A) =&gt; 2, and (any punctuation or non-letter) =&gt; 1.</p>
<p>This includes, incidentally, UTF-8 component bytes in the upper half of the 8 bit space. So all such component bytes count as "just punctuation" in the character n-gram comparisons. As a consequence, n-gram features are next to useless with non-latin alphabets. </p>

<p>Referenced by <a class="el" href="feature__maps_8h.html#a26d7a123154f8cd5cbb70da2c744af58">create_feature_maps()</a>, and <a class="el" href="feature__maps_8c.html#a70d84389e10769651ac8977307897b6a">init_char_map()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ded3a7db80f158c668c5dfd764dca9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int char_map_range = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the top of the range of char_map's outputs </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="feature__maps_8c.html#a23ef6ec1a12d6eea4de5810062a9668c" title="A character map for computing n-gram features. ">char_map</a> </dd></dl>

<p>Referenced by <a class="el" href="feature__maps_8h.html#a26d7a123154f8cd5cbb70da2c744af58">create_feature_maps()</a>, and <a class="el" href="feature__maps_8c.html#a70d84389e10769651ac8977307897b6a">init_char_map()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 17 2017 20:15:19 for CWB by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
